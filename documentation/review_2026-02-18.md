# Code Review Report — PDF Text Extraction Tool
**Date:** 2026-02-18  
**Reviewer:** GitHub Copilot  
**Scope:** Logical correctness, data storage robustness, documentation completeness, private information audit

---

## 1. Logical Issues

| # | Location | Issue | Severity | Status |
|---|---|---|---|---|
| L1 | `ui/main_window.py` — `_update_ocr_status` | Method is defined but **never called**. The OCR status label always shows `"OCR: unknown"`. Should be called in `__init__` and after import. | Medium | Fixed |
| L2 | `ui/main_window.py` — `_on_recognize_finished` | After background recognition, `pdf_viewer.set_boxes()` is **not refreshed** for the currently visible page. Box labels in the viewer may be stale. | Medium | Fixed |
| L3 | `ui/main_window.py` — `_on_apply_box` | Status message reports `"applied to N page(s)"` where N includes the source page (which is skipped). Count is misleading off by one. | Low | Fixed |
| L4 | `ui/pdf_viewer.py` — `wheelEvent` | Wheel zoom uses `±0.05` additive float steps; spin box uses integer `5%` steps. `int()` truncation on `_sync_zoom_spinbox` causes drift over many wheel events. | Low | Fixed |
| L5 | `ui/main_window.py` — `_on_import_finished` | `_update_ocr_status()` should also be triggered after first successful import when context is fully ready. | Low | Fixed (with L1) |
| L6 | `models/data_models.py` — `PDFFileInfo.get_page` | O(n) linear search for every page lookup. Called repeatedly in recognition loops. Consider dict-based indexing for large PDFs. | Low | Documented |
| L7 | `ui/data_table.py` — `_on_cell_changed` / `refresh` | `_editing` flag suppresses infinite-loop risk. Works correctly but is fragile. Documented as a known coupling. | Info | Documented |

---

## 2. Data Storage Robustness

| # | Location | Issue | Severity | Status |
|---|---|---|---|---|
| D1 | `models/data_models.py` — `save_to_json` | **No atomic write.** Direct `open(..., "w")` risks file corruption on crash mid-write. Must write to temp file then `os.replace`. | High | Fixed |
| D2 | `models/data_models.py` — `load_from_json` / `from_dict` | **No schema version or validation.** Silently uses defaults for any missing/renamed keys. Added `version` field and mismatch warning. | Medium | Fixed |
| D3 | `models/data_models.py` — `PDFFileInfo.file_path` | Absolute OS-specific paths stored in JSON. Not portable across machines or when files are moved. Documented as known limitation. | Medium | Documented |
| D4 | `models/data_models.py` — `save_to_json` | **No file lock.** Rapid double-save could race. Low-risk in single-user desktop app but noted. | Low | Documented |
| D5 | `models/data_models.py` — `last_saved_time` | Uses `time.strftime` (local time, no timezone). Switched to `datetime.utcnow().isoformat() + "Z"`. | Low | Fixed |
| D6 | `ui/main_window.py` — `_on_export_excel` | `PermissionError` (file open in Excel) gives opaque OS error text. Now detected specifically with a user-friendly message. | Low | Fixed |

---

## 3. Documentation Completeness

| # | Location | Issue | Severity | Status |
|---|---|---|---|---|
| C1 | `ui/main_window.py` — `_update_ocr_status` | Spec requires OCR label to be **green** (`OCR: on`) or **red** (`OCR: off`). Implementation set text only, no colour. | Medium | Fixed |
| C2 | `ui/main_window.py` — `_on_clear_data`, `_on_export_excel` | Spec requires progress bar for these operations. They run synchronously; added status message + progress pulse. | Low | Fixed |
| C3 | Project root | **No `README.md`** entry point for new developers. | Low | Fixed |
| C4 | `requirements.txt` | Uses `>=` version constraints. Not reproducible. Added comment and pinned lock note. | Low | Documented |
| C5 | `documentation/documentation.html` | Developer section lacked fix log and known limitations. | Medium | Fixed |

---

## 4. Private Information Audit

| # | Location | Finding |
|---|---|---|
| P1 | All source files | **No credentials, tokens, API keys, passwords, or personal data found in source code.** |
| P2 | Saved JSON project files (runtime artefact) | `PDFFileInfo.file_path` stores absolute paths (e.g. `C:\Users\<name>\...`). These are **not** in source but will appear in any project `.json` file that is shared. Users should be warned not to share project JSON files if path privacy is a concern. |

---

## Resolution Summary

- **7 bugs/logic issues found → 5 fixed, 2 documented**
- **6 data storage issues found → 4 fixed, 2 documented**
- **5 documentation gaps found → 4 fixed, 1 documented**
- **0 private information items in source code**

---

*This report was auto-generated by GitHub Copilot code review on 2026-02-18.*
